# Open Development
## [JEO](http://github.com/oeco/jeo) Child theme

Wordpress theme based on [JEO](http://github.com/oeco/jeo). This theme adds custom UI elements and logic.

### Dependencies

#### NPM Dependencies

This project uses Gulp (http://gulpjs.com/) for compressing/minfying CSS/JS files. In order to be able to do so, you need to:

- Install node.js https://nodejs.org/en/download/ which comes with NPM
- It is recommended to update npm <code>sudo npm install npm -g</code>
- Install dependencies with <code>npm install</code>

#### Bower Dependencies

See bower.json file for dependencies. In order to install them:

- install bower globally <code>sudo npm install bower -g</code>
- run ```bower install``` to install dependencies

### Automation

Using Gulp (http://gulpjs.com/), a series of automation tasks can be run in order to:

- ```gulp build-less``` Processes LESS files into a single, minified CSS file
- ```gulp build-styles``` Combines the file generated by the task above with other external css files
- ```gulp build-scripts``` Concatenates and minifies JS files into a single one.
- ```gulp``` Runs all the tasks specified above in a single sequence.
- ```gulp watch``` Watches for file changes on and runs the task sequence.

For more details, see gulpfile.js

### odm-taxonomy

Integrates https://github.com/OpenDevelopmentMekong/odm-taxonomy as submodule.

# Testing

Tests are found on ckanext/odm_dataset/tests and can be run with ```phpunit tests```

# Continuous deployment

Everytime code is pushed to the repository, travis will run the tests available on **/tests**. In case the code has been pushed to **master** branch and tests pass, the **_ci/deploy.sh** script will be called for deploying code in CKAN's DEV instance. Analog to this, and when code from **master** branch has been **tagged as release**, travis will deploy to CKAN's PROD instance automatically.

For the automatic deployment, the scripts on **_ci/** are responsible of downloading the odm-automation repository, decrypting the **odm_tech_rsa.enc** private key file ( encrypted using Travis-ci encryption mechanism) and triggering deployment in either DEV or PROD environment.

# On Windows
## NPM Dependencies 
- Install node.js https://nodejs.org/en/download/ which Windows Installer (Note: NPM comes with, but the version is not uptodate)
- It is recommended to update npm <code>npm install npm -g</code>
- The npm part: It should be there normaly: 
<code>cd C:\Users\USER\AppData\Roaming\npm\node_modules\npm</code>
Add this part to the Enviroment Variable if you npm command unknown.
- CD into the theme directory: cd /wp-content/themes/wp-odm-theme
- Install dependencies with <code>npm install</code> in the theme's directory. (Please clone the theme if you don't have.)

#### Bower Dependencies
- Install bower globally <code> npm install bower -g</code>
- In the theme directory run ```bower install``` to install dependencies

#### Automation
- Install Gulp follow this guidline: https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md
- CD to In the theme directory
- Run ```gulp```  to generate dist folder that contains both js and css for the sites.
- Using Gulp (http://gulpjs.com/), a series of automation tasks can be run in order to: 
	- ```gulp build-less``` Processes LESS files into a single, minified CSS file
	- ```gulp build-styles``` Combines the file generated by the task above with other external css files
	- ```gulp build-scripts``` Concatenates and minifies JS files into a single one.
	- ```gulp``` Runs all the tasks specified above in a single sequence.
	- ```gulp watch``` Watches for file changes on and runs the task sequence.

